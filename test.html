<html>
<script src='./dist/objectexporter.min.js'></script>
<script type="text/javascript">

  function object2csv() {
    var data = [];
    for (let i = 0; i <= 1000; i++) {
      data.push({
        test1: createRandomString(),
        test2: createRandomString()
      });
    }
    objectExporter({
      type: 'csv',
      exportable: data,
      headers: ['header 1', 'header 2']
    })
  }

  function object2xls() {
    var data = [];
    for (let i = 0; i <= 1000; i++) {
      data.push({
        test1: createRandomString(),
        test2: createRandomString()
      });
    }
    objectExporter({
      type: 'xls',
      exportable: data,
      headers: ['header 1', 'header 2', 'empty header'],
      fileName: 'sample_excel',
      headerStyle: 'font-size:16px; font-weight:bold;',
      cellStyle: 'font-size:14px;',
      sheetName: 'sample sheet'
    })
  }

  function createRandomString() {
    var text = "";
    var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
    for (var i = 0; i < 5; i++)
      text += possible.charAt(Math.floor(Math.random() * possible.length));
    return text;
  }
</script>

<body>
  <section id="test" class="test">
    <h1>Object Exporter Test Page</h1>
    <p>
      <button onClick='object2csv();'>
        Export Object to CSV
      </button>
      <button onClick='object2xls();'>
        Export Object to XLS
      </button>
    </p>
  </section>

</body>

</html>